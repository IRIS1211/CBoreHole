<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>&#x202A;CBoreHole: &#x202A;D:/Code/Vision/Camera/Project/CBoreHole/Code/src/SerialProc.cc 源文件</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../Panorama32.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">&#x202A;CBoreHole
   &#160;<span id="projectnumber">1.7.0</span>
   </div>
   <div id="projectbrief">&#x202A;测孔图片拼接全景显示系统</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- 制作者 Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'搜索');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','搜索');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d3/df8/a00155_source.html','../../');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">SerialProc.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d3/df8/a00155.html">浏览该文件的文档.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160; </div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;../stdafx.h&quot;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160; </div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160; </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno"><a class="line" href="../../df/db5/a01158.html#a2eb103016c9d0b4a4e13368ff3e9236c">   21</a></span>&#160;<a class="code" href="../../df/db5/a01158.html#a2eb103016c9d0b4a4e13368ff3e9236c">&#x202A;SerialProc::SerialProc</a>(QObject *parent <span class="comment">/* = nullptr */</span>)</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    :QObject(parent),</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <a class="code" href="../../df/db5/a01158.html#a8d2fa673b460b127ef35bb49b51e8456">&#x202A;m_Serial_</a>(new <a class="code" href="../../d0/d61/a01130.html">&#x202A;Serial</a>()),</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <a class="code" href="../../df/db5/a01158.html#a6b9f98b06cf86f3c91df7b7793bbe4cc">&#x202A;m_Timer_</a>(new QTimer())</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;{</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;}</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="../../df/db5/a01158.html#a47a66594c8c7135fe1b433b7ff0ce079">   40</a></span>&#160;<a class="code" href="../../df/db5/a01158.html#a2eb103016c9d0b4a4e13368ff3e9236c">&#x202A;SerialProc::SerialProc</a>(<span class="keyword">const</span> std::string &amp; input_file, QObject * parent)</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    : QObject(parent),</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <a class="code" href="../../df/db5/a01158.html#a8d2fa673b460b127ef35bb49b51e8456">&#x202A;m_Serial_</a>(new <a class="code" href="../../d0/d61/a01130.html">&#x202A;Serial</a>(input_file)),</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <a class="code" href="../../df/db5/a01158.html#a6b9f98b06cf86f3c91df7b7793bbe4cc">&#x202A;m_Timer_</a>(new QTimer())</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;{</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;}</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="../../df/db5/a01158.html#a4d356bce746d2a91ab02ec10914a34b2">   56</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../df/db5/a01158.html#a4d356bce746d2a91ab02ec10914a34b2">&#x202A;SerialProc::SerialProcInit</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;{</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="comment">// 定时器周期执行 // 一定要 直接连接</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    QObject::connect(<a class="code" href="../../df/db5/a01158.html#a6b9f98b06cf86f3c91df7b7793bbe4cc">&#x202A;m_Timer_</a>, &amp;QTimer::timeout, \</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                     <span class="keyword">this</span>, &amp;<a class="code" href="../../df/db5/a01158.html#a7a4d2b37a6f00109fdde7b593b596d36">&#x202A;SerialProc::slot_timer_peroid_run</a>, \</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                     Qt::DirectConnection);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    QObject::connect(<span class="keyword">this</span>, &amp;<a class="code" href="../../df/db5/a01158.html#a5082babf0d5cc7440c23b944dc8b3c1c">&#x202A;SerialProc::signal_SetTimer</a>, \</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                     <span class="keyword">this</span>, &amp;<a class="code" href="../../df/db5/a01158.html#a1ddf623a0ee307c203a11d4e46e967c7">&#x202A;SerialProc::slot_SetTimerTime</a>, \</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                     Qt::DirectConnection);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="comment">// 设置 缓冲区 大小 为默认缓冲区大小</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <a class="code" href="../../df/db5/a01158.html#ae60e9b12cc8252da2056087cf1c30279">&#x202A;mq_Write_Buffer_</a> = <span class="keyword">new</span> <a class="code" href="../../d0/d56/a01014.html">&#x202A;CQueue&lt;std::string&gt;</a>(<a class="code" href="../../dc/d87/a00032.html#a8cef84e707656a33ac95925cbe84af50">&#x202A;KD_Serial_Buffer_Size</a>);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <a class="code" href="../../df/db5/a01158.html#a57b75e1268073be5bf79694b758c8128">&#x202A;mq_Read_Buffer_</a> = <span class="keyword">new</span> <a class="code" href="../../d0/d56/a01014.html">&#x202A;CQueue&lt;SerialData&gt;</a>(<a class="code" href="../../dc/d87/a00032.html#a8cef84e707656a33ac95925cbe84af50">&#x202A;KD_Serial_Buffer_Size</a>);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="comment">// 设置 串口的函数头</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <a class="code" href="../../df/db5/a01158.html#aed9b7b8c21e584ca95ca43328f1c2e89">&#x202A;m_SerialHeader</a>.<a class="code" href="../../dd/de2/a01134.html#a24f89c030f45de5793c74b58e1a7e7b2">&#x202A;SetFrameByConfig</a>(<a class="code" href="../../d5/df9/a00044.html#a21a3f473a04332ba5d1dd033517f0570">&#x202A;gConfig</a>-&gt;<a class="code" href="../../d0/d2b/a01010.html#a3f1c590ef3c4492e16830021d2867c45">&#x202A;mRunPara</a>.<a class="code" href="../../da/d17/a01046.html#a1b1f21581cf398c15060fe53199662d9">&#x202A;Device</a>.<a class="code" href="../../da/d17/a01046.html#a19d6531d32671e61021a6185e30eba7a">&#x202A;Compass</a>.<a class="code" href="../../da/d17/a01046.html#a15fe499e4b2050a53880aa99049ac839">&#x202A;nComType</a>);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="../../df/db5/a01158.html#ab435c3a24b160674459d01d9a643b82f">&#x202A;m_SerialData_</a> = <span class="keyword">new</span> <a class="code" href="../../dd/de2/a01134.html">&#x202A;SerialData</a>();</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="comment">// 设置 循环更新时间 33 ms</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="comment">// slot_SetTimerTime(-1); // 默认不开启定时器</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <a class="code" href="../../df/db5/a01158.html#a1ddf623a0ee307c203a11d4e46e967c7">&#x202A;slot_SetTimerTime</a>(33);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="comment">// 设置 临时 数据帧</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <a class="code" href="../../df/db5/a01158.html#a07aded3668229182851b344a582912e5">&#x202A;m_FrameData_</a> = <span class="keyword">new</span> <a class="code" href="../../d0/d39/a01138.html">&#x202A;FrameData</a>();</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <a class="code" href="../../df/db5/a01158.html#a8552429aff04eebab8a13073a2537610">&#x202A;mb_Repeat</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="../../df/db5/a01158.html#a8d2fa673b460b127ef35bb49b51e8456">&#x202A;m_Serial_</a>-&gt;<a class="code" href="../../d0/d61/a01130.html#a97f68664ea64cf379c2e35390a0b8ab3">&#x202A;HandleOpenSerial</a>(<a class="code" href="../../d5/df9/a00044.html#a21a3f473a04332ba5d1dd033517f0570">&#x202A;gConfig</a>-&gt;<a class="code" href="../../d0/d2b/a01010.html#a3f1c590ef3c4492e16830021d2867c45">&#x202A;mRunPara</a>.<a class="code" href="../../da/d17/a01046.html#a1b1f21581cf398c15060fe53199662d9">&#x202A;Device</a>.<a class="code" href="../../da/d17/a01046.html#a398126d54ee5504ddea300b512a6a632">&#x202A;Serial</a>.<a class="code" href="../../da/d17/a01046.html#aa4e0416b2441e3488c1b50211bb6f569">&#x202A;nPortNum</a>);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;}</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="../../df/db5/a01158.html#a3be336ed4e3805324cc4b7a5f3589b36">   96</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../df/db5/a01158.html#a3be336ed4e3805324cc4b7a5f3589b36">&#x202A;SerialProc::SerialProcStop</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;{</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <a class="code" href="../../df/db5/a01158.html#a8d2fa673b460b127ef35bb49b51e8456">&#x202A;m_Serial_</a>-&gt;<a class="code" href="../../d0/d61/a01130.html#ab7106342a338373afe7f670fa1dae510">&#x202A;HandleCloseSerial</a>();</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;}</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="../../df/db5/a01158.html#a31a5970045e50bbb739a674cf61ef102">  109</a></span>&#160;<a class="code" href="../../df/db5/a01158.html#a31a5970045e50bbb739a674cf61ef102">&#x202A;SerialProc::~SerialProc</a>()</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;{</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;}</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="../../df/db5/a01158.html#ac112d2c916ab12042aeca02c7f9f0dd4">  128</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../df/db5/a01158.html#ac112d2c916ab12042aeca02c7f9f0dd4">&#x202A;SerialProc::SetOutPutPath</a>(<span class="keyword">const</span> std::string &amp; outFileName)</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;{</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <a class="code" href="../../df/db5/a01158.html#a14fc4ba2d36db04123aa0a1862156945">&#x202A;mb_enWrite</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordflow">try</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <a class="code" href="../../df/db5/a01158.html#adb83fa2df574548f4764ca9e2c78c815">&#x202A;mf_writeFile_</a> = <span class="keyword">new</span> std::fstream(outFileName, std::fstream::out);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordflow">catch</span> (...)</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        LError(<span class="stringliteral">&quot;Out File Create Error: {}&quot;</span>, outFileName);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;}</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno"><a class="line" href="../../df/db5/a01158.html#aecefe574a943886a31f529a16c5b4869">  156</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../df/db5/a01158.html#aecefe574a943886a31f529a16c5b4869">&#x202A;SerialProc::SetCurrentThread</a>(QThread * thread)</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;{</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">if</span> (thread == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="comment">// 设置当前线程</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <a class="code" href="../../df/db5/a01158.html#a935e87599f78d33b665612dd15b8fb1e">&#x202A;mt_SelfThread_</a> = thread;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="comment">// 将串口 移动到线程中</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../df/db5/a01158.html#a8d2fa673b460b127ef35bb49b51e8456">&#x202A;m_Serial_</a>)</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <a class="code" href="../../df/db5/a01158.html#a8d2fa673b460b127ef35bb49b51e8456">&#x202A;m_Serial_</a>-&gt;moveToThread(thread);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="comment">// 将定时器 移动到线程中</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../df/db5/a01158.html#a6b9f98b06cf86f3c91df7b7793bbe4cc">&#x202A;m_Timer_</a>)</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <a class="code" href="../../df/db5/a01158.html#a6b9f98b06cf86f3c91df7b7793bbe4cc">&#x202A;m_Timer_</a>-&gt;moveToThread(thread);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="comment">// 设置线程信号的 开始与关闭</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    QObject::connect(<a class="code" href="../../df/db5/a01158.html#a935e87599f78d33b665612dd15b8fb1e">&#x202A;mt_SelfThread_</a>, &amp;QThread::started, <span class="keyword">this</span>, &amp;<a class="code" href="../../df/db5/a01158.html#a4d356bce746d2a91ab02ec10914a34b2">&#x202A;SerialProc::SerialProcInit</a>,Qt::DirectConnection);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    QObject::connect(<a class="code" href="../../df/db5/a01158.html#a935e87599f78d33b665612dd15b8fb1e">&#x202A;mt_SelfThread_</a>, &amp;QThread::finished, <span class="keyword">this</span>, &amp;<a class="code" href="../../df/db5/a01158.html#a3be336ed4e3805324cc4b7a5f3589b36">&#x202A;SerialProc::SerialProcStop</a>,Qt::DirectConnection);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;}</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno"><a class="line" href="../../df/db5/a01158.html#a6400d403f2fac7c422c43abac3c488ab">  187</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../df/db5/a01158.html#a6400d403f2fac7c422c43abac3c488ab">&#x202A;SerialProc::CompassCalibration</a>()</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;{</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="comment">// 开启校准命令</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="comment">// 停止发送, 开始 1分钟校准</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <a class="code" href="../../d6/d5b/a00026.html#df/dce/a00974">&#x202A;StProtocol</a> protocols;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    std::vector&lt;std::string&gt; CalibrateVec;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    CalibrateVec.push_back(<a class="code" href="../../db/db2/a00020.html#ad7df8e9072eb05862471c2fc24f4f5ce">&#x202A;ComProtEncode</a>(protocols.<a class="code" href="../../d6/d5b/a00026.html#a7cf7e495573f39bf58ee81bbe6b06af9">&#x202A;Output</a>.<a class="code" href="../../d6/d5b/a00026.html#a179f4d70521127a7ba04d95640b01d02">&#x202A;StopSend</a>));</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    CalibrateVec.push_back(<a class="code" href="../../db/db2/a00020.html#ad7df8e9072eb05862471c2fc24f4f5ce">&#x202A;ComProtEncode</a>(protocols.<a class="code" href="../../d6/d5b/a00026.html#a0dc1508ad52c04be88e74cd056bb0162">&#x202A;Calibra</a>.<a class="code" href="../../d2/dd5/a01002.html#afb073012e9c46b3a56b643ab4a1fa245">&#x202A;Calibrate_Time</a>[1]));</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <a class="code" href="../../df/db5/a01158.html#ae48816976f90aeb559fe3207b92c5ab6">&#x202A;SetInterString</a>(CalibrateVec[0]);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="comment">// #TODO(Schen00): 解决串口不返回死循环问题</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">// 等待数据返回 串口接收 停止 // 如果一直为接收到数据 可能出错</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">while</span> (this-&gt;<a class="code" href="../../df/db5/a01158.html#a9258d51d36b09e947413a207f36a9233">&#x202A;m_InterStatus_</a> != <a class="code" href="../../df/db5/a01158.html#aed6d50abf8465c07616ad1b2b10e4928a150abf4d6ee04c6e839c5a9362b9bac0">&#x202A;SerialProc::Readable</a>)</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    }</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    std::string res;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    res = this-&gt;<a class="code" href="../../df/db5/a01158.html#adea2b8f89ed936b9ab23ea75b2e42b7a">&#x202A;GetInterString</a>();</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <a class="code" href="../../d3/d52/a00023.html#ae48ac2456c5ad6c956fef86e7bef3a21">&#x202A;uchar</a> *buf;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">// 写入开始校准命令</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    this-&gt;<a class="code" href="../../df/db5/a01158.html#ae48816976f90aeb559fe3207b92c5ab6">&#x202A;SetInterString</a>(CalibrateVec[1]);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="comment">// 记录进度 和 校准的子进度</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">int</span> status_flg = -1;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">int</span> calibra_progress = 0;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../df/db5/a01158.html#a8d2fa673b460b127ef35bb49b51e8456">&#x202A;m_Serial_</a>-&gt;<a class="code" href="../../d0/d61/a01130.html#a9eb4a207b07b90e03d1e556a131ae174">&#x202A;m_QtSerial_</a>-&gt;isOpen())</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        status_flg = 0;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        LError(<span class="stringliteral">&quot;Serial not Open&quot;</span>);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="comment">// 根据编码 判断状态</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="comment">// 或者 计算 34 字节 计算的值 来判断结果值</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    std::map&lt;uchar, int&gt; StatusMap = {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        { 0x08,0 },</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        { 0xF9,1 },</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        { 0xA8,2 }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    };</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    std::string other_str = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> CommBits = protocols.<a class="code" href="../../d6/d5b/a00026.html#a0dc1508ad52c04be88e74cd056bb0162">&#x202A;Calibra</a>.<a class="code" href="../../d2/dd5/a01002.html#a5e1f32fca6e13783bbaf82b80cb9a9e8">&#x202A;CommBits</a>;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordtype">bool</span> finish_ = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="comment">// 循环接收数据</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordflow">while</span> (!finish_)</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="keywordflow">if</span> ((!other_str.empty()) || this-&gt;<a class="code" href="../../df/db5/a01158.html#a9258d51d36b09e947413a207f36a9233">&#x202A;m_InterStatus_</a> == <a class="code" href="../../df/db5/a01158.html#aed6d50abf8465c07616ad1b2b10e4928a150abf4d6ee04c6e839c5a9362b9bac0">&#x202A;SerialProc::Readable</a>)</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            <span class="comment">// 每次将数据读取出来, 取出前面的部分作为本次使用, 剩下的部分 下次使用</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            std::string <a class="code" href="../../df/d98/a00107.html#abe29b0d0f446a335c8586ae898a768ed">&#x202A;tmp</a> = this-&gt;<a class="code" href="../../df/db5/a01158.html#adea2b8f89ed936b9ab23ea75b2e42b7a">&#x202A;GetInterString</a>();</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            tmp = other_str + <a class="code" href="../../df/d98/a00107.html#abe29b0d0f446a335c8586ae898a768ed">&#x202A;tmp</a>;  <span class="comment">// 前面添加上一次的结果</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            LDebug(<span class="stringliteral">&quot;Cur Recv:{}&quot;</span>, \</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                   <a class="code" href="../../d9/de6/a01314.html#a343a35752b0575e884df5b0758cadfda">&#x202A;Utils_String::CharArr2Hex</a>((<a class="code" href="../../d3/d52/a00023.html#ae48ac2456c5ad6c956fef86e7bef3a21">&#x202A;uchar</a>*)<a class="code" href="../../df/d98/a00107.html#abe29b0d0f446a335c8586ae898a768ed">&#x202A;tmp</a>.c_str(),</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                                             <a class="code" href="../../df/d98/a00107.html#abe29b0d0f446a335c8586ae898a768ed">&#x202A;tmp</a>.size()));</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            <span class="comment">// 提前已经做过判断 处理数据不为空</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            assert((<a class="code" href="../../df/d98/a00107.html#abe29b0d0f446a335c8586ae898a768ed">&#x202A;tmp</a>[0] == 0x68));</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            <span class="comment">// 本次数据不够长</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../df/d98/a00107.html#abe29b0d0f446a335c8586ae898a768ed">&#x202A;tmp</a>.size() &lt; 6)</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            {</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                other_str = <a class="code" href="../../df/d98/a00107.html#abe29b0d0f446a335c8586ae898a768ed">&#x202A;tmp</a>;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            }</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                <span class="comment">// 根据当前帧的长度 截取一部分 剩下的部分 后续处理</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                res = <a class="code" href="../../df/d98/a00107.html#abe29b0d0f446a335c8586ae898a768ed">&#x202A;tmp</a>.substr(0, <a class="code" href="../../df/d98/a00107.html#abe29b0d0f446a335c8586ae898a768ed">&#x202A;tmp</a>[1] + 1);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                other_str = <a class="code" href="../../df/d98/a00107.html#abe29b0d0f446a335c8586ae898a768ed">&#x202A;tmp</a>.substr(res.size());</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            }</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            <span class="comment">// 确保 res 是 0x68 开头的 6 -7个字节</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            assert(res.size() &gt;= 6);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            assert(res[0] == 0x68);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            assert(res[1] + 1 == res.size());</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            <a class="code" href="../../d3/d52/a00023.html#ae48ac2456c5ad6c956fef86e7bef3a21">&#x202A;uchar</a> tmp_ = (<a class="code" href="../../d3/d52/a00023.html#ae48ac2456c5ad6c956fef86e7bef3a21">&#x202A;uchar</a>)res[CommBits];</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            <span class="comment">// 如果不存在 错误</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            <span class="keywordflow">if</span> (StatusMap.count(tmp_))</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                <span class="keywordflow">switch</span> (StatusMap[tmp_])</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                {</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                    <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                    {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                        <span class="comment">// 区分 08 是在哪一步</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                        <span class="keywordflow">if</span> (status_flg == 0)</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                        {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                            <span class="keywordflow">if</span> (res[CommBits + 1] == 0x00)</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                                status_flg = 1;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                            LInfo(<span class="stringliteral">&quot;Status:\t{}&quot;</span>, \</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                                  protocols.<a class="code" href="../../d6/d5b/a00026.html#a0dc1508ad52c04be88e74cd056bb0162">&#x202A;Calibra</a>.<a class="code" href="../../d2/dd5/a01002.html#a5d6a41e36c7ccb662c05f63b875f39f3">&#x202A;StatusString</a>[status_flg]);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                        }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (status_flg == 3)</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                        {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                            status_flg = 4;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                            <span class="keywordtype">bool</span> c_result = (res[CommBits + 1] == 0x0f);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                            other_str = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                            LInfo(<span class="stringliteral">&quot;Status:\t{} {}&quot;</span>, \</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                                  protocols.<a class="code" href="../../d6/d5b/a00026.html#a0dc1508ad52c04be88e74cd056bb0162">&#x202A;Calibra</a>.<a class="code" href="../../d2/dd5/a01002.html#a5d6a41e36c7ccb662c05f63b875f39f3">&#x202A;StatusString</a>[status_flg], \</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                                  c_result ? <span class="stringliteral">&quot;Success&quot;</span> : <span class="stringliteral">&quot;Failed&quot;</span>);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                            <span class="comment">// finish_ = true;  // 用于控制循环执行 可以直接返回 </span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                        }</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                    } <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                    <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                    {</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                        <span class="comment">// 获取校准的子 进程完成度</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                        status_flg = 2;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                        calibra_progress = res[CommBits + 1];</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                        LInfo(<span class="stringliteral">&quot;Status:\t{} Recv:{}/26&quot;</span>, </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                              protocols.<a class="code" href="../../d6/d5b/a00026.html#a0dc1508ad52c04be88e74cd056bb0162">&#x202A;Calibra</a>.<a class="code" href="../../d2/dd5/a01002.html#a5d6a41e36c7ccb662c05f63b875f39f3">&#x202A;StatusString</a>[status_flg],</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                              calibra_progress);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                    } <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                    <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                    {</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                        status_flg = 3;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                        <span class="comment">// 计算大端序的两个直接</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                        <span class="keywordtype">int</span> residual = <a class="code" href="../../d4/d34/a01298.html#a3608435d58a43711699c72db402154fb">&#x202A;Utils_Data::Calc</a>(\</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                            (<a class="code" href="../../d3/d52/a00023.html#ae48ac2456c5ad6c956fef86e7bef3a21">&#x202A;uchar</a>*)&amp;res[CommBits + 1], 2);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                        LInfo(<span class="stringliteral">&quot;Status:\t{} \tresidual:{}&quot;</span>,</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                              protocols.<a class="code" href="../../d6/d5b/a00026.html#a0dc1508ad52c04be88e74cd056bb0162">&#x202A;Calibra</a>.<a class="code" href="../../d2/dd5/a01002.html#a5d6a41e36c7ccb662c05f63b875f39f3">&#x202A;StatusString</a>[status_flg],</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                              residual);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                    }</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160; </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                        assert(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;            }</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        }</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    }</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;}</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00342"></a><span class="lineno"><a class="line" href="../../df/db5/a01158.html#a30681f14980014f263933507dea5f077">  342</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../df/db5/a01158.html#a30681f14980014f263933507dea5f077">&#x202A;SerialProc::RepeatProcSerialData</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;{</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../df/db5/a01158.html#a8d2fa673b460b127ef35bb49b51e8456">&#x202A;m_Serial_</a>)</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    {</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        std::string write_data;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        QString str;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <span class="comment">// 将数据输出</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        QByteArray read_data;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="../../df/db5/a01158.html#ae60e9b12cc8252da2056087cf1c30279">&#x202A;mq_Write_Buffer_</a>-&gt;<a class="code" href="../../d0/d56/a01014.html#a4d55a1a82ab1aa26325a0c93e2603c3f">&#x202A;Empty</a>())</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            <a class="code" href="../../df/db5/a01158.html#ae60e9b12cc8252da2056087cf1c30279">&#x202A;mq_Write_Buffer_</a>-&gt;<a class="code" href="../../d0/d56/a01014.html#aabb5d6f90ce5562f4d30867de96bc983">&#x202A;Pop</a>(write_data);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            <span class="comment">// str = QString::fromStdString(write_data);</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            <span class="comment">// LDebug(&quot;write:{},\n str:{}&quot;, write_data, str.toStdString());</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            <a class="code" href="../../df/db5/a01158.html#a8d2fa673b460b127ef35bb49b51e8456">&#x202A;m_Serial_</a>-&gt;<a class="code" href="../../d0/d61/a01130.html#a96e9f96c16f56bcbb4ed0945b0c69782">&#x202A;slot_write_data</a>(&amp;write_data);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        }</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <span class="comment">// 读取一帧数据</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <a class="code" href="../../df/db5/a01158.html#a8d2fa673b460b127ef35bb49b51e8456">&#x202A;m_Serial_</a>-&gt;<a class="code" href="../../d0/d61/a01130.html#ab3ea56749f8b01fa4da75d8164cb8dc5">&#x202A;slot_read_data</a>(&amp;read_data);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <a class="code" href="../../df/db5/a01158.html#a501d9387b58680267b0dfd9e5c569fdb">&#x202A;ProcData</a>(read_data, <a class="code" href="../../df/db5/a01158.html#a57b75e1268073be5bf79694b758c8128">&#x202A;mq_Read_Buffer_</a>);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <span class="comment">// 将队列里面的数据 取出一帧 更新 frame 数据</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="../../df/db5/a01158.html#a57b75e1268073be5bf79694b758c8128">&#x202A;mq_Read_Buffer_</a>-&gt;<a class="code" href="../../d0/d56/a01014.html#a4d55a1a82ab1aa26325a0c93e2603c3f">&#x202A;Empty</a>())</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        {</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../df/db5/a01158.html#a57b75e1268073be5bf79694b758c8128">&#x202A;mq_Read_Buffer_</a>-&gt;<a class="code" href="../../d0/d56/a01014.html#aabb5d6f90ce5562f4d30867de96bc983">&#x202A;Pop</a>(*<a class="code" href="../../df/db5/a01158.html#ab435c3a24b160674459d01d9a643b82f">&#x202A;m_SerialData_</a>))</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            {</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                <span class="comment">// LDebug(&quot;CharArr--:{}&quot;, Utils_String::ShowCharArr(m_SerialData_-&gt;mc_Data_, 27));</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                <a class="code" href="../../df/db5/a01158.html#a07aded3668229182851b344a582912e5">&#x202A;m_FrameData_</a>-&gt;<a class="code" href="../../d0/d39/a01138.html#a071b93d33a06aea86d23514be375d4cd">&#x202A;Update</a>(*<a class="code" href="../../df/db5/a01158.html#ab435c3a24b160674459d01d9a643b82f">&#x202A;m_SerialData_</a>);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            }</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        }</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        <span class="comment">// 如果开启写入 将数据写入到文件中 // 原始 未整理数据 </span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../df/db5/a01158.html#a14fc4ba2d36db04123aa0a1862156945">&#x202A;mb_enWrite</a>)</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            <a class="code" href="../../d7/d8c/a01306.html#a0100eaf1e914cee3b70157898026a375">&#x202A;Utils_Files::WriteStringTxt</a>(<a class="code" href="../../df/db5/a01158.html#adb83fa2df574548f4764ca9e2c78c815">&#x202A;mf_writeFile_</a>, read_data.toHex(<span class="charliteral">&#39; &#39;</span>).toStdString());</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        }</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    }</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;}</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00397"></a><span class="lineno"><a class="line" href="../../df/db5/a01158.html#aca565b69167068c3d03888f396e46189">  397</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../df/db5/a01158.html#aca565b69167068c3d03888f396e46189">&#x202A;SerialProc::InteractiveProcSerial</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;{</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="comment">// 根据 m_InterStatus_ 来表示状态, </span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="comment">//     // 0 从串口读取数据 准备写 , </span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="comment">//     // 1 有数据等待写入串口, </span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="comment">//     // 2 有数据已经读取 等待使用</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../df/db5/a01158.html#a9258d51d36b09e947413a207f36a9233">&#x202A;m_InterStatus_</a> == <a class="code" href="../../df/db5/a01158.html#aed6d50abf8465c07616ad1b2b10e4928ae354f0e3ebba350516b1e1288e617d72">&#x202A;None</a>)</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    {</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        <span class="keyword">static</span> QByteArray read_data;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        <span class="comment">// 延时一个周期, 避免数据接收不到</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        Sleep(<a class="code" href="../../dc/d87/a00032.html#a5331e763f1b8e64b460eed460ec6de60">&#x202A;K_Timer_Time_MS</a>);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <a class="code" href="../../df/db5/a01158.html#a8d2fa673b460b127ef35bb49b51e8456">&#x202A;m_Serial_</a>-&gt;<a class="code" href="../../d0/d61/a01130.html#ab3ea56749f8b01fa4da75d8164cb8dc5">&#x202A;slot_read_data</a>(&amp;read_data);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        <span class="comment">// 如果数据一直读取的为空, 表示串口未发送数据</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        <span class="keyword">static</span> <span class="keywordtype">int</span> empty_cnt = 0;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        <span class="keywordflow">if</span> (!read_data.isEmpty())</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;            <span class="comment">// 将字符串设置为 等待读取</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            <a class="code" href="../../df/db5/a01158.html#ae48816976f90aeb559fe3207b92c5ab6">&#x202A;SetInterString</a>(read_data.toStdString(), <a class="code" href="../../df/db5/a01158.html#aed6d50abf8465c07616ad1b2b10e4928a150abf4d6ee04c6e839c5a9362b9bac0">&#x202A;Readable</a>);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            empty_cnt = 0;      <span class="comment">// 接收到一次数据 就可以清零</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        }</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        {</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            empty_cnt ++;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            <span class="comment">// 连续超时, 程序log 错误 </span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;            <span class="keywordflow">if</span> (empty_cnt &gt;= 10)</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            {</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                <span class="comment">// #TODO(Schen00)  处理连续超时错误</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                <span class="comment">// LError(&quot;Time out No Response&quot;);</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                empty_cnt = 0;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            }</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        }</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    }</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../df/db5/a01158.html#a9258d51d36b09e947413a207f36a9233">&#x202A;m_InterStatus_</a> == <a class="code" href="../../df/db5/a01158.html#aed6d50abf8465c07616ad1b2b10e4928a847c215c9358665a866a59a415520617">&#x202A;Writeable</a>)</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    {</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <span class="comment">// 数据为空, 获取数据 并将数据写入到串口发送出去</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        <a class="code" href="../../df/db5/a01158.html#a8d2fa673b460b127ef35bb49b51e8456">&#x202A;m_Serial_</a>-&gt;<a class="code" href="../../d0/d61/a01130.html#a96e9f96c16f56bcbb4ed0945b0c69782">&#x202A;slot_write_data</a>(&amp;<a class="code" href="../../df/db5/a01158.html#adea2b8f89ed936b9ab23ea75b2e42b7a">&#x202A;GetInterString</a>());</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    }</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../df/db5/a01158.html#a9258d51d36b09e947413a207f36a9233">&#x202A;m_InterStatus_</a> == <a class="code" href="../../df/db5/a01158.html#aed6d50abf8465c07616ad1b2b10e4928a150abf4d6ee04c6e839c5a9362b9bac0">&#x202A;Readable</a>)</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    {</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        <span class="comment">// 等待用户取出字符串, 不使用的话 字符串不会更新 不允许新的字符串回复</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        <span class="comment">// LDebug(&quot;Should have to read from string &quot;);</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    }</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    {</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        LError(<span class="stringliteral">&quot;Error InterStatus:{}, Please Check SerprocStatus&quot;</span>, <a class="code" href="../../df/db5/a01158.html#a9258d51d36b09e947413a207f36a9233">&#x202A;m_InterStatus_</a>);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    }</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;}</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160; </div>
<div class="line"><a name="l00458"></a><span class="lineno"><a class="line" href="../../df/db5/a01158.html#adea2b8f89ed936b9ab23ea75b2e42b7a">  458</a></span>&#160;std::string <a class="code" href="../../df/db5/a01158.html#adea2b8f89ed936b9ab23ea75b2e42b7a">&#x202A;SerialProc::GetInterString</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;{</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    std::lock_guard&lt;std::mutex&gt; lk(<a class="code" href="../../df/db5/a01158.html#a9be388c13cd2714603bed425d94d8d73">&#x202A;mx_Inter_</a>);  </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <a class="code" href="../../df/db5/a01158.html#a9258d51d36b09e947413a207f36a9233">&#x202A;m_InterStatus_</a> = <a class="code" href="../../df/db5/a01158.html#aed6d50abf8465c07616ad1b2b10e4928ae354f0e3ebba350516b1e1288e617d72">&#x202A;None</a>;      <span class="comment">// 表示操作完了, 等待后续操作</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="comment">// 将数据 返回 并将原始数据清空</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    std::string res = <a class="code" href="../../df/db5/a01158.html#a458d1fa7a53deee1a2ccf5d264892376">&#x202A;m_InterString</a>;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <a class="code" href="../../df/db5/a01158.html#a458d1fa7a53deee1a2ccf5d264892376">&#x202A;m_InterString</a> = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;}</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160; </div>
<div class="line"><a name="l00480"></a><span class="lineno"><a class="line" href="../../df/db5/a01158.html#ae48816976f90aeb559fe3207b92c5ab6">  480</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../df/db5/a01158.html#ae48816976f90aeb559fe3207b92c5ab6">&#x202A;SerialProc::SetInterString</a>(<span class="keyword">const</span> std::string &amp; str, <span class="keywordtype">int</span> status)</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;{</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    std::lock_guard&lt;std::mutex&gt; lk(<a class="code" href="../../df/db5/a01158.html#a9be388c13cd2714603bed425d94d8d73">&#x202A;mx_Inter_</a>);  </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    assert(status == <a class="code" href="../../df/db5/a01158.html#aed6d50abf8465c07616ad1b2b10e4928a847c215c9358665a866a59a415520617">&#x202A;Writeable</a> || status == <a class="code" href="../../df/db5/a01158.html#aed6d50abf8465c07616ad1b2b10e4928a150abf4d6ee04c6e839c5a9362b9bac0">&#x202A;Readable</a>);     </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <a class="code" href="../../df/db5/a01158.html#a9258d51d36b09e947413a207f36a9233">&#x202A;m_InterStatus_</a> = status;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <a class="code" href="../../df/db5/a01158.html#a458d1fa7a53deee1a2ccf5d264892376">&#x202A;m_InterString</a> = str;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;}</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160; </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160; </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160; </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160; </div>
<div class="line"><a name="l00504"></a><span class="lineno"><a class="line" href="../../df/db5/a01158.html#a501d9387b58680267b0dfd9e5c569fdb">  504</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../df/db5/a01158.html#a501d9387b58680267b0dfd9e5c569fdb">&#x202A;SerialProc::ProcData</a>(<span class="keyword">const</span> QByteArray &amp; recv, </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                          <a class="code" href="../../d0/d56/a01014.html">&#x202A;CQueue&lt;SerialData&gt;</a>* read_queue)</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;{</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160; </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">int</span> data_cnt = 0;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">int</span> flg_status = 0;  <span class="comment">// 0 普通数据,与数据头1 比较, 1 数据头1,2 数据头2, 3 数据头3,</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                                <span class="comment">// 每次将缓冲区 数据全部读出来,</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                                <span class="comment">// 判断上一帧读取到了什么状态, 数据分为 前4个字节的帧头数据和 后面的数据</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                                <span class="comment">// 1.读取到了帧头 // 2. 读取到了一般数据帧</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                                <span class="comment">// 每次计数, 读取到帧头的时候, 判断数据是否已经满了, 已经满了进行数据校验, 满足就加入数据</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                                <span class="comment">// 数据未满, 则可能数据未满, </span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160; </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="keywordtype">int</span> N = recv.size();</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="keywordflow">if</span> (recv.isEmpty())</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    {</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        <span class="comment">// LError(&quot;recv data is empty&quot;);</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    }</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160; </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="comment">// LDebug(&quot;Recv Serial Data:{}&quot;, recv.toHex(&#39; &#39;).toStdString());</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160; </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="comment">// 遍历得到的数据数组</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; N; i++)</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    {</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        <a class="code" href="../../d3/d52/a00023.html#ae48ac2456c5ad6c956fef86e7bef3a21">&#x202A;uchar</a> <a class="code" href="../../df/d98/a00107.html#abe29b0d0f446a335c8586ae898a768ed">&#x202A;tmp</a> = <a class="code" href="../../d9/de6/a01314.html#a3d87ca32cf1959251d87988a5b7f1b45">&#x202A;Utils_String::UChar2Char</a>(recv[i]);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160; </div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        <span class="comment">// 每次来了数据与上次的置位比较, 如果一致, 比较后一位, </span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        <span class="comment">//  如果前面4位都一致,表示已经开始了新的一帧, 将数据依次复制</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        <span class="comment">//    如果数据已经满足帧头, 将之前的数据 校验满足之后加入队列中, 其他线程处理</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../df/d98/a00107.html#abe29b0d0f446a335c8586ae898a768ed">&#x202A;tmp</a> == <a class="code" href="../../df/db5/a01158.html#aed9b7b8c21e584ca95ca43328f1c2e89">&#x202A;m_SerialHeader</a>.<a class="code" href="../../dd/de2/a01134.html#a381a10030c4ed28b8cb7fc1b01de3ff6">&#x202A;mc_Head_</a>[flg_status])</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        {</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;            flg_status++;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;            <span class="keywordflow">if</span> (flg_status &gt;= 4)</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;            {</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                <span class="comment">// 计算最后数据域的5个字节的 和校验 // 如果满足  压入数据</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                <span class="keywordflow">if</span>(!<a class="code" href="../../d9/de6/a01314.html#ac3b5b7bb59df157b42934895a67738e8">&#x202A;Utils_String::Commu_CheckSum</a>(&amp;<a class="code" href="../../df/db5/a01158.html#aed9b7b8c21e584ca95ca43328f1c2e89">&#x202A;m_SerialHeader</a>.<a class="code" href="../../dd/de2/a01134.html#a3790e9109615a7c93f395e45d0d6166c">&#x202A;mc_Data_</a>[<a class="code" href="../../df/db5/a01158.html#aed9b7b8c21e584ca95ca43328f1c2e89">&#x202A;m_SerialHeader</a>.<a class="code" href="../../dd/de2/a01134.html#a2e29d7356cb17ae57bf407bae34226d6">&#x202A;mi_DataLen_</a> - 6], 5))</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                    LError(<span class="stringliteral">&quot;Data Sum Check:False  data-{}&quot;</span>, <a class="code" href="../../d9/de6/a01314.html#a343a35752b0575e884df5b0758cadfda">&#x202A;Utils_String::CharArr2Hex</a>(<a class="code" href="../../df/db5/a01158.html#aed9b7b8c21e584ca95ca43328f1c2e89">&#x202A;m_SerialHeader</a>.<a class="code" href="../../dd/de2/a01134.html#a3790e9109615a7c93f395e45d0d6166c">&#x202A;mc_Data_</a>, <a class="code" href="../../df/db5/a01158.html#aed9b7b8c21e584ca95ca43328f1c2e89">&#x202A;m_SerialHeader</a>.<a class="code" href="../../dd/de2/a01134.html#a2e29d7356cb17ae57bf407bae34226d6">&#x202A;mi_DataLen_</a>));</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160; </div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                <span class="comment">// 由于存在每次存入数据的时候存在上一帧的数据 问题 所以这里校验可能失败</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                read_queue-&gt;<a class="code" href="../../d0/d56/a01014.html#a282e80149935f212e9c6c6e8ef9d7374">&#x202A;Push</a>(<a class="code" href="../../df/db5/a01158.html#aed9b7b8c21e584ca95ca43328f1c2e89">&#x202A;m_SerialHeader</a>);</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                <span class="comment">// 更新前面4个字节的帧头数据</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; i++)</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                    <a class="code" href="../../df/db5/a01158.html#aed9b7b8c21e584ca95ca43328f1c2e89">&#x202A;m_SerialHeader</a>.<a class="code" href="../../dd/de2/a01134.html#a3790e9109615a7c93f395e45d0d6166c">&#x202A;mc_Data_</a>[i] = <a class="code" href="../../df/db5/a01158.html#aed9b7b8c21e584ca95ca43328f1c2e89">&#x202A;m_SerialHeader</a>.<a class="code" href="../../dd/de2/a01134.html#a381a10030c4ed28b8cb7fc1b01de3ff6">&#x202A;mc_Head_</a>[i];</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                <span class="comment">// 匹配重新置零, 同时将数据前面数据复制过去</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                flg_status = 0;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;            }</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        }</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        {</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;            flg_status = 0; <span class="comment">// 如果前面的匹配上了, 后面匹配不上, 则重新开始进行匹配</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        }</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        <a class="code" href="../../df/db5/a01158.html#aed9b7b8c21e584ca95ca43328f1c2e89">&#x202A;m_SerialHeader</a>.<a class="code" href="../../dd/de2/a01134.html#a3790e9109615a7c93f395e45d0d6166c">&#x202A;mc_Data_</a>[data_cnt++] = <a class="code" href="../../df/d98/a00107.html#abe29b0d0f446a335c8586ae898a768ed">&#x202A;tmp</a>;    <span class="comment">// 移动指针, 将数据存储到数组中</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                                                     <span class="comment">// 超过设定值, 减去一个长度,避免越界  // 与取与操作 % 处理一致 </span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                                                     <span class="comment">// 重新开始的位置 从可以刷新的数据开始</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <span class="keywordflow">if</span> (data_cnt == <a class="code" href="../../df/db5/a01158.html#aed9b7b8c21e584ca95ca43328f1c2e89">&#x202A;m_SerialHeader</a>.<a class="code" href="../../dd/de2/a01134.html#a2e29d7356cb17ae57bf407bae34226d6">&#x202A;mi_DataLen_</a>)</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;            data_cnt = 0;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    }</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;}</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160; </div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160; </div>
<div class="line"><a name="l00573"></a><span class="lineno"><a class="line" href="../../df/db5/a01158.html#a7a4d2b37a6f00109fdde7b593b596d36">  573</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../df/db5/a01158.html#a7a4d2b37a6f00109fdde7b593b596d36">&#x202A;SerialProc::slot_timer_peroid_run</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;{</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="comment">// 根据 是否开启循环接收 判断交互模式</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../df/db5/a01158.html#a8552429aff04eebab8a13073a2537610">&#x202A;mb_Repeat</a>)</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    {</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        <a class="code" href="../../df/db5/a01158.html#a30681f14980014f263933507dea5f077">&#x202A;RepeatProcSerialData</a>();</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    }</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    {</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        <a class="code" href="../../df/db5/a01158.html#aca565b69167068c3d03888f396e46189">&#x202A;InteractiveProcSerial</a>();</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    }</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;}</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160; </div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160; </div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160; </div>
<div class="line"><a name="l00599"></a><span class="lineno"><a class="line" href="../../df/db5/a01158.html#a1ddf623a0ee307c203a11d4e46e967c7">  599</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../df/db5/a01158.html#a1ddf623a0ee307c203a11d4e46e967c7">&#x202A;SerialProc::slot_SetTimerTime</a>(<span class="keywordtype">int</span> t)</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;{</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../df/db5/a01158.html#a6b9f98b06cf86f3c91df7b7793bbe4cc">&#x202A;m_Timer_</a>)</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    {</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../df/db5/a01158.html#a6b9f98b06cf86f3c91df7b7793bbe4cc">&#x202A;m_Timer_</a>-&gt;isActive())</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            <a class="code" href="../../df/db5/a01158.html#a6b9f98b06cf86f3c91df7b7793bbe4cc">&#x202A;m_Timer_</a>-&gt;stop();</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        <span class="keywordflow">if</span>(t != -1)</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            <a class="code" href="../../df/db5/a01158.html#a6b9f98b06cf86f3c91df7b7793bbe4cc">&#x202A;m_Timer_</a>-&gt;start(t);</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    }</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;}</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="aa01046_html_a1b1f21581cf398c15060fe53199662d9"><div class="ttname"><a href="../../da/d17/a01046.html#a1b1f21581cf398c15060fe53199662d9">&#x202A;RunPara::Device</a></div><div class="ttdeci">&#x202A;struct RunPara::StDevice Device</div></div>
<div class="ttc" id="aa00026_html_a0dc1508ad52c04be88e74cd056bb0162"><div class="ttname"><a href="../../d6/d5b/a00026.html#a0dc1508ad52c04be88e74cd056bb0162">&#x202A;StProtocol::Calibra</a></div><div class="ttdeci">&#x202A;struct StProtocol::StCalibra Calibra</div></div>
<div class="ttc" id="aa01130_html_a9eb4a207b07b90e03d1e556a131ae174"><div class="ttname"><a href="../../d0/d61/a01130.html#a9eb4a207b07b90e03d1e556a131ae174">&#x202A;Serial::m_QtSerial_</a></div><div class="ttdeci">&#x202A;QSerialPort * m_QtSerial_</div><div class="ttdoc">&#x202A;Qt 串口对象</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dee/a00053_source.html#l00042">Serial.h:42</a></div></div>
<div class="ttc" id="aa01158_html_a8552429aff04eebab8a13073a2537610"><div class="ttname"><a href="../../df/db5/a01158.html#a8552429aff04eebab8a13073a2537610">&#x202A;SerialProc::mb_Repeat</a></div><div class="ttdeci">&#x202A;bool mb_Repeat</div><div class="ttdoc">&#x202A;是否开启循环读取</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d8b/a00059_source.html#l00096">SerialProc.h:96</a></div></div>
<div class="ttc" id="aa00023_html_ae48ac2456c5ad6c956fef86e7bef3a21"><div class="ttname"><a href="../../d3/d52/a00023.html#ae48ac2456c5ad6c956fef86e7bef3a21">&#x202A;uchar</a></div><div class="ttdeci">&#x202A;unsigned char uchar</div><div class="ttdoc">&#x202A;The uchar</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d52/a00023_source.html#l00026">Commu.h:26</a></div></div>
<div class="ttc" id="aa01158_html_a7a4d2b37a6f00109fdde7b593b596d36"><div class="ttname"><a href="../../df/db5/a01158.html#a7a4d2b37a6f00109fdde7b593b596d36">&#x202A;SerialProc::slot_timer_peroid_run</a></div><div class="ttdeci">&#x202A;void slot_timer_peroid_run(void)</div><div class="ttdoc">&#x202A;设置周期 定时器 执行的内容</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/df8/a00155_source.html#l00573">SerialProc.cc:573</a></div></div>
<div class="ttc" id="aa01158_html_aed9b7b8c21e584ca95ca43328f1c2e89"><div class="ttname"><a href="../../df/db5/a01158.html#aed9b7b8c21e584ca95ca43328f1c2e89">&#x202A;SerialProc::m_SerialHeader</a></div><div class="ttdeci">&#x202A;SerialData m_SerialHeader</div><div class="ttdoc">&#x202A;单独存放串口头信息的</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d8b/a00059_source.html#l00100">SerialProc.h:100</a></div></div>
<div class="ttc" id="aa01046_html_a15fe499e4b2050a53880aa99049ac839"><div class="ttname"><a href="../../da/d17/a01046.html#a15fe499e4b2050a53880aa99049ac839">&#x202A;RunPara::StDevice::StCompass::nComType</a></div><div class="ttdeci">&#x202A;int nComType</div><div class="ttdoc">&#x202A;当前使用的罗盘类</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de0/a00050_source.html#l00186">runpara.h:186</a></div></div>
<div class="ttc" id="aa01158_html_ac112d2c916ab12042aeca02c7f9f0dd4"><div class="ttname"><a href="../../df/db5/a01158.html#ac112d2c916ab12042aeca02c7f9f0dd4">&#x202A;SerialProc::SetOutPutPath</a></div><div class="ttdeci">&#x202A;bool SetOutPutPath(const std::string &amp;outFileName)</div><div class="ttdoc">&#x202A;执行之后 会将文件数据依次写入文件中, 不执行默认不写入文件</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/df8/a00155_source.html#l00128">SerialProc.cc:128</a></div></div>
<div class="ttc" id="aa01314_html_a3d87ca32cf1959251d87988a5b7f1b45"><div class="ttname"><a href="../../d9/de6/a01314.html#a3d87ca32cf1959251d87988a5b7f1b45">&#x202A;Utils_String::UChar2Char</a></div><div class="ttdeci">&#x202A;static char UChar2Char(uchar c1)</div><div class="ttdoc">&#x202A;Uchar 2 char 的相互转换</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/a00275_source.html#l00329">utils_string.cc:329</a></div></div>
<div class="ttc" id="aa01158_html_aed6d50abf8465c07616ad1b2b10e4928a847c215c9358665a866a59a415520617"><div class="ttname"><a href="../../df/db5/a01158.html#aed6d50abf8465c07616ad1b2b10e4928a847c215c9358665a866a59a415520617">&#x202A;SerialProc::Writeable</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d8b/a00059_source.html#l00092">SerialProc.h:92</a></div></div>
<div class="ttc" id="aa01158_html_aed6d50abf8465c07616ad1b2b10e4928a150abf4d6ee04c6e839c5a9362b9bac0"><div class="ttname"><a href="../../df/db5/a01158.html#aed6d50abf8465c07616ad1b2b10e4928a150abf4d6ee04c6e839c5a9362b9bac0">&#x202A;SerialProc::Readable</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d8b/a00059_source.html#l00093">SerialProc.h:93</a></div></div>
<div class="ttc" id="aa01014_html_a282e80149935f212e9c6c6e8ef9d7374"><div class="ttname"><a href="../../d0/d56/a01014.html#a282e80149935f212e9c6c6e8ef9d7374">&#x202A;CQueue::Push</a></div><div class="ttdeci">&#x202A;bool Push(T &amp;data)</div><div class="ttdoc">&#x202A;队列中加入新的 对象 根据情况决定 满信号之后 新数据丢弃或者等待</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8c/a00035_source.html#l00114">CQueue.h:114</a></div></div>
<div class="ttc" id="aa01046_html_a398126d54ee5504ddea300b512a6a632"><div class="ttname"><a href="../../da/d17/a01046.html#a398126d54ee5504ddea300b512a6a632">&#x202A;RunPara::StDevice::Serial</a></div><div class="ttdeci">&#x202A;struct RunPara::StDevice::StSerial Serial</div></div>
<div class="ttc" id="aa01158_html_a458d1fa7a53deee1a2ccf5d264892376"><div class="ttname"><a href="../../df/db5/a01158.html#a458d1fa7a53deee1a2ccf5d264892376">&#x202A;SerialProc::m_InterString</a></div><div class="ttdeci">&#x202A;std::string m_InterString</div><div class="ttdoc">&#x202A;交互式对话存储字符串 存储写入和读取</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d8b/a00059_source.html#l00110">SerialProc.h:110</a></div></div>
<div class="ttc" id="aa01130_html"><div class="ttname"><a href="../../d0/d61/a01130.html">&#x202A;Serial</a></div><div class="ttdoc">&#x202A;A serial.</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dee/a00053_source.html#l00038">Serial.h:38</a></div></div>
<div class="ttc" id="aa01158_html_a6400d403f2fac7c422c43abac3c488ab"><div class="ttname"><a href="../../df/db5/a01158.html#a6400d403f2fac7c422c43abac3c488ab">&#x202A;SerialProc::CompassCalibration</a></div><div class="ttdeci">&#x202A;bool CompassCalibration()</div><div class="ttdoc">&#x202A;Determines if we can compass calibration</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/df8/a00155_source.html#l00187">SerialProc.cc:187</a></div></div>
<div class="ttc" id="aa01158_html_a30681f14980014f263933507dea5f077"><div class="ttname"><a href="../../df/db5/a01158.html#a30681f14980014f263933507dea5f077">&#x202A;SerialProc::RepeatProcSerialData</a></div><div class="ttdeci">&#x202A;bool RepeatProcSerialData(void)</div><div class="ttdoc">&#x202A;循环处理 串口 数据</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/df8/a00155_source.html#l00342">SerialProc.cc:342</a></div></div>
<div class="ttc" id="aa01158_html_a8d2fa673b460b127ef35bb49b51e8456"><div class="ttname"><a href="../../df/db5/a01158.html#a8d2fa673b460b127ef35bb49b51e8456">&#x202A;SerialProc::m_Serial_</a></div><div class="ttdeci">&#x202A;Serial * m_Serial_</div><div class="ttdoc">&#x202A;The serial</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d8b/a00059_source.html#l00081">SerialProc.h:81</a></div></div>
<div class="ttc" id="aa01158_html_a9be388c13cd2714603bed425d94d8d73"><div class="ttname"><a href="../../df/db5/a01158.html#a9be388c13cd2714603bed425d94d8d73">&#x202A;SerialProc::mx_Inter_</a></div><div class="ttdeci">&#x202A;std::mutex mx_Inter_</div><div class="ttdoc">&#x202A;交互操作锁</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d8b/a00059_source.html#l00108">SerialProc.h:108</a></div></div>
<div class="ttc" id="aa01158_html_aed6d50abf8465c07616ad1b2b10e4928ae354f0e3ebba350516b1e1288e617d72"><div class="ttname"><a href="../../df/db5/a01158.html#aed6d50abf8465c07616ad1b2b10e4928ae354f0e3ebba350516b1e1288e617d72">&#x202A;SerialProc::None</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d8b/a00059_source.html#l00091">SerialProc.h:91</a></div></div>
<div class="ttc" id="aa01134_html_a3790e9109615a7c93f395e45d0d6166c"><div class="ttname"><a href="../../dd/de2/a01134.html#a3790e9109615a7c93f395e45d0d6166c">&#x202A;SerialData::mc_Data_</a></div><div class="ttdeci">&#x202A;uchar * mc_Data_</div><div class="ttdoc">&#x202A;帧数据</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d2e/a00056_source.html#l00033">serialdata.h:33</a></div></div>
<div class="ttc" id="aa01130_html_ab3ea56749f8b01fa4da75d8164cb8dc5"><div class="ttname"><a href="../../d0/d61/a01130.html#ab3ea56749f8b01fa4da75d8164cb8dc5">&#x202A;Serial::slot_read_data</a></div><div class="ttdeci">&#x202A;void slot_read_data(QByteArray *data)</div><div class="ttdoc">&#x202A;读取数据</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d1e/a00149_source.html#l00148">Serial.cc:148</a></div></div>
<div class="ttc" id="aa01130_html_ab7106342a338373afe7f670fa1dae510"><div class="ttname"><a href="../../d0/d61/a01130.html#ab7106342a338373afe7f670fa1dae510">&#x202A;Serial::HandleCloseSerial</a></div><div class="ttdeci">&#x202A;void HandleCloseSerial(void)</div><div class="ttdoc">&#x202A;Handles the close serial</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d1e/a00149_source.html#l00260">Serial.cc:260</a></div></div>
<div class="ttc" id="aa01158_html_a14fc4ba2d36db04123aa0a1862156945"><div class="ttname"><a href="../../df/db5/a01158.html#a14fc4ba2d36db04123aa0a1862156945">&#x202A;SerialProc::mb_enWrite</a></div><div class="ttdeci">&#x202A;bool mb_enWrite</div><div class="ttdoc">&#x202A;是否写入数据</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d8b/a00059_source.html#l00104">SerialProc.h:104</a></div></div>
<div class="ttc" id="aa01314_html_ac3b5b7bb59df157b42934895a67738e8"><div class="ttname"><a href="../../d9/de6/a01314.html#ac3b5b7bb59df157b42934895a67738e8">&#x202A;Utils_String::Commu_CheckSum</a></div><div class="ttdeci">&#x202A;static uchar Commu_CheckSum(const std::string &amp;str)</div><div class="ttdoc">&#x202A;计算 校验和</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/a00275_source.html#l00792">utils_string.cc:792</a></div></div>
<div class="ttc" id="aa01298_html_a3608435d58a43711699c72db402154fb"><div class="ttname"><a href="../../d4/d34/a01298.html#a3608435d58a43711699c72db402154fb">&#x202A;Utils_Data::Calc</a></div><div class="ttdeci">&#x202A;static int Calc(uchar *dat, int len)</div><div class="ttdoc">&#x202A;通用计算函数 计算从 指针开始的指定位数的 计算结果</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d1a/a00251_source.html#l00078">utils_data.cc:78</a></div></div>
<div class="ttc" id="aa01138_html_a071b93d33a06aea86d23514be375d4cd"><div class="ttname"><a href="../../d0/d39/a01138.html#a071b93d33a06aea86d23514be375d4cd">&#x202A;FrameData::Update</a></div><div class="ttdeci">&#x202A;bool Update(SerialData &amp;ser_data)</div><div class="ttdoc">&#x202A;根据串口数据 更新当前类的值</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d2e/a00056_source.html#l00238">serialdata.h:238</a></div></div>
<div class="ttc" id="aa01158_html_aecefe574a943886a31f529a16c5b4869"><div class="ttname"><a href="../../df/db5/a01158.html#aecefe574a943886a31f529a16c5b4869">&#x202A;SerialProc::SetCurrentThread</a></div><div class="ttdeci">&#x202A;bool SetCurrentThread(QThread *thread)</div><div class="ttdoc">&#x202A;Sets current thread</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/df8/a00155_source.html#l00156">SerialProc.cc:156</a></div></div>
<div class="ttc" id="aa01158_html_a57b75e1268073be5bf79694b758c8128"><div class="ttname"><a href="../../df/db5/a01158.html#a57b75e1268073be5bf79694b758c8128">&#x202A;SerialProc::mq_Read_Buffer_</a></div><div class="ttdeci">&#x202A;CQueue&lt; SerialData &gt; * mq_Read_Buffer_</div><div class="ttdoc">&#x202A;Buffer for mq read data</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d8b/a00059_source.html#l00079">SerialProc.h:79</a></div></div>
<div class="ttc" id="aa01130_html_a97f68664ea64cf379c2e35390a0b8ab3"><div class="ttname"><a href="../../d0/d61/a01130.html#a97f68664ea64cf379c2e35390a0b8ab3">&#x202A;Serial::HandleOpenSerial</a></div><div class="ttdeci">&#x202A;void HandleOpenSerial(int port_no)</div><div class="ttdoc">&#x202A;Handles the open serial</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d1e/a00149_source.html#l00234">Serial.cc:234</a></div></div>
<div class="ttc" id="aa01158_html_a31a5970045e50bbb739a674cf61ef102"><div class="ttname"><a href="../../df/db5/a01158.html#a31a5970045e50bbb739a674cf61ef102">&#x202A;SerialProc::~SerialProc</a></div><div class="ttdeci">&#x202A;~SerialProc()</div><div class="ttdoc">&#x202A;Finalizes an instance of the SerialProc class</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/df8/a00155_source.html#l00109">SerialProc.cc:109</a></div></div>
<div class="ttc" id="aa01138_html"><div class="ttname"><a href="../../d0/d39/a01138.html">&#x202A;FrameData</a></div><div class="ttdoc">&#x202A;定义数据帧头像</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d2e/a00056_source.html#l00175">serialdata.h:175</a></div></div>
<div class="ttc" id="aa00026_html_df/dce/a00974"><div class="ttname"><a href="../../d6/d5b/a00026.html#df/dce/a00974">&#x202A;StProtocol</a></div><div class="ttdoc">&#x202A;定义串通讯协议对应指令 详细介绍信息 参考 电子罗盘协议3.1版本pdf 定义相应的字符串, 在发送的时候 前缀 '#' 后缀 '*' 然后加入 8位异或校验 最后加上 /n/r</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d5b/a00026_source.html#l00021">CompassProtocol.h:21</a></div></div>
<div class="ttc" id="aa01158_html_adea2b8f89ed936b9ab23ea75b2e42b7a"><div class="ttname"><a href="../../df/db5/a01158.html#adea2b8f89ed936b9ab23ea75b2e42b7a">&#x202A;SerialProc::GetInterString</a></div><div class="ttdeci">&#x202A;std::string GetInterString(void)</div><div class="ttdoc">&#x202A;get set 字符串 并设置相应 标志位 获取交互字符串</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/df8/a00155_source.html#l00458">SerialProc.cc:458</a></div></div>
<div class="ttc" id="aa01158_html_a1ddf623a0ee307c203a11d4e46e967c7"><div class="ttname"><a href="../../df/db5/a01158.html#a1ddf623a0ee307c203a11d4e46e967c7">&#x202A;SerialProc::slot_SetTimerTime</a></div><div class="ttdeci">&#x202A;void slot_SetTimerTime(int t)</div><div class="ttdoc">&#x202A;Slot set timer time</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/df8/a00155_source.html#l00599">SerialProc.cc:599</a></div></div>
<div class="ttc" id="aa01158_html_adb83fa2df574548f4764ca9e2c78c815"><div class="ttname"><a href="../../df/db5/a01158.html#adb83fa2df574548f4764ca9e2c78c815">&#x202A;SerialProc::mf_writeFile_</a></div><div class="ttdeci">&#x202A;std::fstream * mf_writeFile_</div><div class="ttdoc">&#x202A;给定文件指针 用于记录接受到的数据</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d8b/a00059_source.html#l00105">SerialProc.h:105</a></div></div>
<div class="ttc" id="aa01158_html_a3be336ed4e3805324cc4b7a5f3589b36"><div class="ttname"><a href="../../df/db5/a01158.html#a3be336ed4e3805324cc4b7a5f3589b36">&#x202A;SerialProc::SerialProcStop</a></div><div class="ttdeci">&#x202A;void SerialProcStop(void)</div><div class="ttdoc">&#x202A;Serial proc stop</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/df8/a00155_source.html#l00096">SerialProc.cc:96</a></div></div>
<div class="ttc" id="aa00032_html_a8cef84e707656a33ac95925cbe84af50"><div class="ttname"><a href="../../dc/d87/a00032.html#a8cef84e707656a33ac95925cbe84af50">&#x202A;KD_Serial_Buffer_Size</a></div><div class="ttdeci">&#x202A;const int KD_Serial_Buffer_Size</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d87/a00032_source.html#l00033">constdefine.h:33</a></div></div>
<div class="ttc" id="aa01010_html_a3f1c590ef3c4492e16830021d2867c45"><div class="ttname"><a href="../../d0/d2b/a01010.html#a3f1c590ef3c4492e16830021d2867c45">&#x202A;Config::mRunPara</a></div><div class="ttdeci">&#x202A;RunPara mRunPara</div><div class="ttdoc">&#x202A;系统运行参数</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/a00029_source.html#l00034">Config.h:34</a></div></div>
<div class="ttc" id="aa00044_html_a21a3f473a04332ba5d1dd033517f0570"><div class="ttname"><a href="../../d5/df9/a00044.html#a21a3f473a04332ba5d1dd033517f0570">&#x202A;gConfig</a></div><div class="ttdeci">&#x202A;Config * gConfig</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db1/a00140_source.html#l00014">main.cpp:14</a></div></div>
<div class="ttc" id="aa01134_html"><div class="ttname"><a href="../../dd/de2/a01134.html">&#x202A;SerialData</a></div><div class="ttdoc">&#x202A;暂存 串口发送回来的 分组数据 保存串口发送的原始数据</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d2e/a00056_source.html#l00027">serialdata.h:27</a></div></div>
<div class="ttc" id="aa01158_html_a2eb103016c9d0b4a4e13368ff3e9236c"><div class="ttname"><a href="../../df/db5/a01158.html#a2eb103016c9d0b4a4e13368ff3e9236c">&#x202A;SerialProc::SerialProc</a></div><div class="ttdeci">&#x202A;SerialProc(QObject *parent=nullptr)</div><div class="ttdoc">&#x202A;Initializes a new instance of the SerialProc class</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/df8/a00155_source.html#l00021">SerialProc.cc:21</a></div></div>
<div class="ttc" id="aa00020_html_ad7df8e9072eb05862471c2fc24f4f5ce"><div class="ttname"><a href="../../db/db2/a00020.html#ad7df8e9072eb05862471c2fc24f4f5ce">&#x202A;ComProtEncode</a></div><div class="ttdeci">&#x202A;std::string ComProtEncode(const std::string &amp;str)</div><div class="ttdoc">&#x202A;参考 [电子罗盘协议3.1版本pdf] 定义相应的字符串, 在发送的时候 前缀 '#' 后缀 '*'</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dc8/a00122_source.html#l00063">common.cc:63</a></div></div>
<div class="ttc" id="aa01158_html_a07aded3668229182851b344a582912e5"><div class="ttname"><a href="../../df/db5/a01158.html#a07aded3668229182851b344a582912e5">&#x202A;SerialProc::m_FrameData_</a></div><div class="ttdeci">&#x202A;FrameData * m_FrameData_</div><div class="ttdoc">&#x202A;计算出来的一帧数据</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d8b/a00059_source.html#l00102">SerialProc.h:102</a></div></div>
<div class="ttc" id="aa00107_html_abe29b0d0f446a335c8586ae898a768ed"><div class="ttname"><a href="../../df/d98/a00107.html#abe29b0d0f446a335c8586ae898a768ed">&#x202A;tmp</a></div><div class="ttdeci">&#x202A;cv::Mat tmp</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/a00107_source.html#l00037">QImgLabel.cc:37</a></div></div>
<div class="ttc" id="aa00032_html_a5331e763f1b8e64b460eed460ec6de60"><div class="ttname"><a href="../../dc/d87/a00032.html#a5331e763f1b8e64b460eed460ec6de60">&#x202A;K_Timer_Time_MS</a></div><div class="ttdeci">&#x202A;const int K_Timer_Time_MS</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d87/a00032_source.html#l00031">constdefine.h:31</a></div></div>
<div class="ttc" id="aa01014_html"><div class="ttname"><a href="../../d0/d56/a01014.html">&#x202A;CQueue&lt; std::string &gt;</a></div></div>
<div class="ttc" id="aa01002_html_a5e1f32fca6e13783bbaf82b80cb9a9e8"><div class="ttname"><a href="../../d2/dd5/a01002.html#a5e1f32fca6e13783bbaf82b80cb9a9e8">&#x202A;StProtocol::StCalibra::CommBits</a></div><div class="ttdeci">&#x202A;static const int CommBits</div><div class="ttdoc">&#x202A;默认的命令字的字节位置</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d5b/a00026_source.html#l00157">CompassProtocol.h:157</a></div></div>
<div class="ttc" id="aa01158_html_a9258d51d36b09e947413a207f36a9233"><div class="ttname"><a href="../../df/db5/a01158.html#a9258d51d36b09e947413a207f36a9233">&#x202A;SerialProc::m_InterStatus_</a></div><div class="ttdeci">&#x202A;int m_InterStatus_</div><div class="ttdoc">&#x202A;交互状态的标志位</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d8b/a00059_source.html#l00097">SerialProc.h:97</a></div></div>
<div class="ttc" id="aa01014_html_aabb5d6f90ce5562f4d30867de96bc983"><div class="ttname"><a href="../../d0/d56/a01014.html#aabb5d6f90ce5562f4d30867de96bc983">&#x202A;CQueue::Pop</a></div><div class="ttdeci">&#x202A;bool Pop(T &amp;data)</div><div class="ttdoc">&#x202A;返回队列最前面的元素 并且弹出 // 如果空 如果finish 则直接返回fasle 否则 等待队列加入元素</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8c/a00035_source.html#l00150">CQueue.h:150</a></div></div>
<div class="ttc" id="aa01158_html_ae48816976f90aeb559fe3207b92c5ab6"><div class="ttname"><a href="../../df/db5/a01158.html#ae48816976f90aeb559fe3207b92c5ab6">&#x202A;SerialProc::SetInterString</a></div><div class="ttdeci">&#x202A;void SetInterString(const std::string &amp;str, int status=Writeable)</div><div class="ttdoc">&#x202A;设置交互字符串 1. 表示状态 从其他地方设置 等待写入 2. 表示读取上来之后, 等待读取</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/df8/a00155_source.html#l00480">SerialProc.cc:480</a></div></div>
<div class="ttc" id="aa01046_html_aa4e0416b2441e3488c1b50211bb6f569"><div class="ttname"><a href="../../da/d17/a01046.html#aa4e0416b2441e3488c1b50211bb6f569">&#x202A;RunPara::StDevice::StSerial::nPortNum</a></div><div class="ttdeci">&#x202A;int nPortNum</div><div class="ttdoc">&#x202A;串口号</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de0/a00050_source.html#l00214">runpara.h:214</a></div></div>
<div class="ttc" id="aa01014_html_a4d55a1a82ab1aa26325a0c93e2603c3f"><div class="ttname"><a href="../../d0/d56/a01014.html#a4d55a1a82ab1aa26325a0c93e2603c3f">&#x202A;CQueue::Empty</a></div><div class="ttdeci">&#x202A;bool Empty(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8c/a00035_source.html#l00321">CQueue.h:321</a></div></div>
<div class="ttc" id="aa01134_html_a2e29d7356cb17ae57bf407bae34226d6"><div class="ttname"><a href="../../dd/de2/a01134.html#a2e29d7356cb17ae57bf407bae34226d6">&#x202A;SerialData::mi_DataLen_</a></div><div class="ttdeci">&#x202A;int mi_DataLen_</div><div class="ttdoc">&#x202A;数据帧长度</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d2e/a00056_source.html#l00035">serialdata.h:35</a></div></div>
<div class="ttc" id="aa01306_html_a0100eaf1e914cee3b70157898026a375"><div class="ttname"><a href="../../d7/d8c/a01306.html#a0100eaf1e914cee3b70157898026a375">&#x202A;Utils_Files::WriteStringTxt</a></div><div class="ttdeci">&#x202A;static bool WriteStringTxt(std::fstream *pfile, const std::string &amp;str)</div><div class="ttdoc">&#x202A;Writes a string text</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd7/a00260_source.html#l00134">utils_files.cc:134</a></div></div>
<div class="ttc" id="aa01158_html_a4d356bce746d2a91ab02ec10914a34b2"><div class="ttname"><a href="../../df/db5/a01158.html#a4d356bce746d2a91ab02ec10914a34b2">&#x202A;SerialProc::SerialProcInit</a></div><div class="ttdeci">&#x202A;void SerialProcInit(void)</div><div class="ttdoc">&#x202A;设置初始化</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/df8/a00155_source.html#l00056">SerialProc.cc:56</a></div></div>
<div class="ttc" id="aa01158_html_a935e87599f78d33b665612dd15b8fb1e"><div class="ttname"><a href="../../df/db5/a01158.html#a935e87599f78d33b665612dd15b8fb1e">&#x202A;SerialProc::mt_SelfThread_</a></div><div class="ttdeci">&#x202A;QThread * mt_SelfThread_</div><div class="ttdoc">&#x202A;记录当前的线程指针</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d8b/a00059_source.html#l00099">SerialProc.h:99</a></div></div>
<div class="ttc" id="aa01158_html_a501d9387b58680267b0dfd9e5c569fdb"><div class="ttname"><a href="../../df/db5/a01158.html#a501d9387b58680267b0dfd9e5c569fdb">&#x202A;SerialProc::ProcData</a></div><div class="ttdeci">&#x202A;bool ProcData(const QByteArray &amp;recv, CQueue&lt; SerialData &gt; *read_queue)</div><div class="ttdoc">&#x202A;将数据处理 如果正确 加入到自己的队列中</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/df8/a00155_source.html#l00504">SerialProc.cc:504</a></div></div>
<div class="ttc" id="aa01002_html_afb073012e9c46b3a56b643ab4a1fa245"><div class="ttname"><a href="../../d2/dd5/a01002.html#afb073012e9c46b3a56b643ab4a1fa245">&#x202A;StProtocol::StCalibra::Calibrate_Time</a></div><div class="ttdeci">&#x202A;std::vector&lt; std::string &gt; Calibrate_Time</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d5b/a00026_source.html#l00138">CompassProtocol.h:138</a></div></div>
<div class="ttc" id="aa01002_html_a5d6a41e36c7ccb662c05f63b875f39f3"><div class="ttname"><a href="../../d2/dd5/a01002.html#a5d6a41e36c7ccb662c05f63b875f39f3">&#x202A;StProtocol::StCalibra::StatusString</a></div><div class="ttdeci">&#x202A;const std::vector&lt; std::string &gt; StatusString</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d5b/a00026_source.html#l00147">CompassProtocol.h:147</a></div></div>
<div class="ttc" id="aa01158_html_a5082babf0d5cc7440c23b944dc8b3c1c"><div class="ttname"><a href="../../df/db5/a01158.html#a5082babf0d5cc7440c23b944dc8b3c1c">&#x202A;SerialProc::signal_SetTimer</a></div><div class="ttdeci">&#x202A;void signal_SetTimer(int t)</div><div class="ttdoc">&#x202A;Raises a Set timer signal</div></div>
<div class="ttc" id="aa01046_html_a19d6531d32671e61021a6185e30eba7a"><div class="ttname"><a href="../../da/d17/a01046.html#a19d6531d32671e61021a6185e30eba7a">&#x202A;RunPara::StDevice::Compass</a></div><div class="ttdeci">&#x202A;struct RunPara::StDevice::StCompass Compass</div></div>
<div class="ttc" id="aa01158_html_ab435c3a24b160674459d01d9a643b82f"><div class="ttname"><a href="../../df/db5/a01158.html#ab435c3a24b160674459d01d9a643b82f">&#x202A;SerialProc::m_SerialData_</a></div><div class="ttdeci">&#x202A;SerialData * m_SerialData_</div><div class="ttdoc">&#x202A;设置读取一帧数据 存放位置</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d8b/a00059_source.html#l00101">SerialProc.h:101</a></div></div>
<div class="ttc" id="aa01314_html_a343a35752b0575e884df5b0758cadfda"><div class="ttname"><a href="../../d9/de6/a01314.html#a343a35752b0575e884df5b0758cadfda">&#x202A;Utils_String::CharArr2Hex</a></div><div class="ttdeci">&#x202A;static std::string CharArr2Hex(uchar *buffer, int length=16, int flg_space=1)</div><div class="ttdoc">&#x202A;Character array 2 hexadecimal 数组 转换成 hex 字符</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/a00275_source.html#l00701">utils_string.cc:701</a></div></div>
<div class="ttc" id="aa01134_html_a381a10030c4ed28b8cb7fc1b01de3ff6"><div class="ttname"><a href="../../dd/de2/a01134.html#a381a10030c4ed28b8cb7fc1b01de3ff6">&#x202A;SerialData::mc_Head_</a></div><div class="ttdeci">&#x202A;uchar * mc_Head_</div><div class="ttdoc">&#x202A;帧头数据</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d2e/a00056_source.html#l00034">serialdata.h:34</a></div></div>
<div class="ttc" id="aa01158_html_ae60e9b12cc8252da2056087cf1c30279"><div class="ttname"><a href="../../df/db5/a01158.html#ae60e9b12cc8252da2056087cf1c30279">&#x202A;SerialProc::mq_Write_Buffer_</a></div><div class="ttdeci">&#x202A;CQueue&lt; std::string &gt; * mq_Write_Buffer_</div><div class="ttdoc">&#x202A;Buffer for mq write data</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d8b/a00059_source.html#l00080">SerialProc.h:80</a></div></div>
<div class="ttc" id="aa00026_html_a179f4d70521127a7ba04d95640b01d02"><div class="ttname"><a href="../../d6/d5b/a00026.html#a179f4d70521127a7ba04d95640b01d02">&#x202A;StProtocol::StOutputMode::StopSend</a></div><div class="ttdeci">&#x202A;std::string StopSend</div><div class="ttdoc">&#x202A;停止发送</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d5b/a00026_source.html#l00123">CompassProtocol.h:123</a></div></div>
<div class="ttc" id="aa00026_html_a7cf7e495573f39bf58ee81bbe6b06af9"><div class="ttname"><a href="../../d6/d5b/a00026.html#a7cf7e495573f39bf58ee81bbe6b06af9">&#x202A;StProtocol::Output</a></div><div class="ttdeci">&#x202A;struct StProtocol::StOutputMode Output</div></div>
<div class="ttc" id="aa01134_html_a24f89c030f45de5793c74b58e1a7e7b2"><div class="ttname"><a href="../../dd/de2/a01134.html#a24f89c030f45de5793c74b58e1a7e7b2">&#x202A;SerialData::SetFrameByConfig</a></div><div class="ttdeci">&#x202A;bool SetFrameByConfig(int compass_type=2)</div><div class="ttdoc">&#x202A;Sets frame header 根据罗盘类型设置通信协议</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9a/a00152_source.html#l00090">serialdata.cc:90</a></div></div>
<div class="ttc" id="aa01130_html_a96e9f96c16f56bcbb4ed0945b0c69782"><div class="ttname"><a href="../../d0/d61/a01130.html#a96e9f96c16f56bcbb4ed0945b0c69782">&#x202A;Serial::slot_write_data</a></div><div class="ttdeci">&#x202A;void slot_write_data(std::string *str, bool flg_hex=false)</div><div class="ttdoc">&#x202A;Slot write data // 将字符串写入到串口中去 判断是否输出的 hex 字符串</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d1e/a00149_source.html#l00179">Serial.cc:179</a></div></div>
<div class="ttc" id="aa01158_html_aca565b69167068c3d03888f396e46189"><div class="ttname"><a href="../../df/db5/a01158.html#aca565b69167068c3d03888f396e46189">&#x202A;SerialProc::InteractiveProcSerial</a></div><div class="ttdeci">&#x202A;bool InteractiveProcSerial(void)</div><div class="ttdoc">&#x202A;交互式处理数据 // 写入一句 读取一句</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/df8/a00155_source.html#l00397">SerialProc.cc:397</a></div></div>
<div class="ttc" id="aa01158_html_a6b9f98b06cf86f3c91df7b7793bbe4cc"><div class="ttname"><a href="../../df/db5/a01158.html#a6b9f98b06cf86f3c91df7b7793bbe4cc">&#x202A;SerialProc::m_Timer_</a></div><div class="ttdeci">&#x202A;QTimer * m_Timer_</div><div class="ttdoc">&#x202A;设置定时执行功能, 完成之后</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d8b/a00059_source.html#l00082">SerialProc.h:82</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_23fdee2f6995db16c755697cdf620cf4.html">&#x202A;Code</a></li><li class="navelem"><a class="el" href="../../dir_562250f81d431c2e4bf06f5f84066d42.html">&#x202A;src</a></li><li class="navelem"><a class="el" href="../../d3/df8/a00155.html">&#x202A;SerialProc.cc</a></li>
    <li class="footer">制作者
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.16 </li>
  </ul>
</div>
</body>
</html>
